Content-Type: multipart/mixed; boundary="===============7832870659841679070=="
MIME-Version: 1.0

--===============7832870659841679070==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="uCernVM-master"

[amiconfig]
plugins=elastiq-setup condor

[condor]
use_ips=true
highport=42000
condor_user=condor
lowport=41000
condor_secret=12345
condor_group=condor
uid_domain=*

[elastiq-setup]
elastiq_check_queue_every_s=10
elastiq_idle_for_time_s=idle-time
elastiq_waiting_jobs_time_s=20
elastiq_n_jobs_per_vm=jobs-per-vm
elastiq_batch_plugin=htcondor
elastiq_estimated_vm_deploy_time_s=300
elastiq_check_vms_every_s=15
ec2_key_name=key-name

ec2_api_url=ec2-url
ec2_aws_secret_access_key=secret-key
ec2_aws_access_key_id=access-key
ec2_image_id=image-id
ec2_flavour=instance-flavor

ec2_user_data_b64=W2FtaWNvbmZpZ10NCnBsdWdpbnM9Y29uZG9yIHZhZi1zZXR1cA0KDQpbY29uZG9yXQ0KdXNlX2lwcz10cnVlDQpoaWdocG9ydD00MjAwMA0KY29uZG9yX3VzZXI9Y29uZG9yDQpsb3dwb3J0PTQxMDAwDQpjb25kb3Jfc2VjcmV0PTEyMzQ1DQpjb25kb3JfbWFzdGVyPSVpcHY0JQ0KY29uZG9yX2dyb3VwPWNvbmRvcg0KdWlkX2RvbWFpbj0qDQoNClt2YWYtc2V0dXBdDQpub2RlX3R5cGU9c2xhdmUNCg==

cacerts_b64=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tDQpNSUlGd2pDQ0E2cWdBd0lCQWdJSkFMTW1Bc1o5U1NZbk1BMEdDU3FHU0liM0RRRUJDd1VBTUVNeEN6QUpCZ05WDQpCQVlUQWtsVU1RMHdDd1lEVlFRS0V3UkpUa1pPTVNVd0l3WURWUVFERXh4SlRrWk9JRU5sY25ScFptbGpZWFJwDQpiMjRnUVhWMGFHOXlhWFI1TUI0WERURTFNVEF3TmpFd01qSXdOVm9YRFRNd01UQXdOakV3TWpJd05Wb3dRekVMDQpNQWtHQTFVRUJoTUNTVlF4RFRBTEJnTlZCQW9UQkVsT1JrNHhKVEFqQmdOVkJBTVRIRWxPUms0Z1EyVnlkR2xtDQphV05oZEdsdmJpQkJkWFJvYjNKcGRIa3dnZ0lpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElDRHdBd2dnSUtBb0lDDQpBUURpWGRSN2tmSzdkcWM1dFFDRFozWUtEODlGaXpHRmhvMnBCeHpkZFVtalZFYkVCZU9tRy8veks0Rm1Ca3U4DQozU1RpZDNZbVlPY01NZjhDMG5BVkdrdGRqdzJocVlWalArcHc3bW5tV0ZvZy9tTk1rdy9RNy9hdkxlb2lZOEkrDQpwSnRXS1BDYmhUWkluSzU5ay9LY0xzN2JyYXVWNCtmQkJwMnZzY09wTThqNFk2VEg3TUFKTHNyWWRkemd4Q29FDQpJdmpaNWNSWGNQSERON24yV2hvak43MFh0bFFmaFlOalVsU0dJb3FkVlhPRUtWQkVHNzRPbGc4ODhBR2VvRlB4DQpTYzVGYUxsTTBHZUtMZ1JZWXREVXU4dEdNZGhNZENUZ1JUNTE1UDM2djQxUDdLNHdaR01leFJiNGw3Qk1IVk5mDQpsamxWcWpyOEwyZjJnNER5MjFIWkREbEZmY29xNlZ6bHRjRHBGM3M4bzUvcjNlUWlHVldUU1MxSlhKcFhMSlRjDQpkdmo0cTZoUFFFc2RreUgyYXFjdlMwNk4yWFdXRzI3bnAwSnpWc2lwQVA5V1JZeUxBSk8rRVR0d09PdnF0YWtGDQo3SnJQME5iNmp5U1JQeS9RbWZZK2pLbXdmNmhKM1dIcS84LzZHcjFWUlRxMHNpK1pDNDZuWTg5cFlmKytRTEtrDQpjZ2U3dUt2ZGR4ZXBvTFY5M0h4L0dNR2M5NmpBdEQvUjRYY1JmUmpPLzErOXJ3Qk9YWk5MZU5Wb0Q1ZUNqK0FkDQpOREYxTUwvWWE4R3YzQU9WSk5jeUFjTTE0NVZiRnBoWndrU1RoM005RFJCS1RxeVFJQlZWQUY3NWNwa1UxM3FhDQpkUUJRUU9oaUZBWkNTU3hMRzZJcTBsVzVLc2ZRcUhkMTNYYVNvclBJVi9wODB3SURBUUFCbzRHNE1JRzFNQThHDQpBMVVkRXdFQi93UUZNQU1CQWY4d0RnWURWUjBQQVFIL0JBUURBZ0VHTUIwR0ExVWREZ1FXQkJSRGpFMys3SmJLDQo2ZThLcEgzQm5RTGxuNzJXZ0RCekJnTlZIU01FYkRCcWdCUkRqRTMrN0piSzZlOEtwSDNCblFMbG43MldnS0ZIDQpwRVV3UXpFTE1Ba0dBMVVFQmhNQ1NWUXhEVEFMQmdOVkJBb1RCRWxPUms0eEpUQWpCZ05WQkFNVEhFbE9SazRnDQpRMlZ5ZEdsbWFXTmhkR2x2YmlCQmRYUm9iM0pwZEhtQ0NRQ3pKZ0xHZlVrbUp6QU5CZ2txaGtpRzl3MEJBUXNGDQpBQU9DQWdFQXowbmVjMHN0R3kzMCtoTlJONTJOaTVZWUNNRkZvWDRhRDdMZHJXdCtNVDg2aTRVRnp2UFJ3dk9wDQpiUGNQQzYzc2pRYlAramVQZ0ZYc21FYVBrREt1ZjB4MzQ0bE55QWdJVStKRldpbmM0Z3Y0bk41b0hmdVNYRzZKDQpVVGZZTEhhVnVQYWhLZUhVVXBCT3l0eU9NRFJLRytGbEdPeFF2aG5vaGhqVXdCZmZidTFGSXU5OTMrZDB3MkdDDQo5WjR6VCtHVUtTbHZpT1VZYnpjdER1RzBEOEZWV0pLN0w1U3NqRlNQU2ZDSmxiV0tHbWRwRE5WMnZOemthSHNBDQpkUTEzV3F4RThiMEpUSGRwUzN2c3J2ZlNlaFk0SUc0RmoySHFzREUvZGZsSDNnY0piNWw0bHM4a2NBNTNZUkcyDQpORFRqdmpkcTN0djVBbFlKekhLY3hxMXZoVW1WeDF2a2cxYVlOZ2NWOG04d2tQaHNuUXVUZGlRbThFQTNJdE9PDQpSTllhd2Z1VmVTMDIxUlh3UkwyOTBIRklsZndtNmltUm1sS2VwR3ZKQldiclZkcnJMQ3E0czVVUGpjeG5RblpFDQp0YXBRUFV0ZlYxbTlWL1Q2OWg1anJmVnkxbk1NNFdXQTZNVlBsamxvbDFrNzJqQXJtK29Ydm9FdkRpTmZqMnFqDQpnZnZWMDNSNEdYeFArMEVXRlhhYzR0aUZGdTZZQzRIdTdvdTM4dG5uVy9ueCt4dXJ2bnN4SVc3WkRhTEdLQ2QrDQpWSm1iK3FoVTNOSnZEUEdqRHVrc1hwMGlkZmhiSzZSMmRGejdVRlMxRFlkUml0N2plWnBvdTVENExhSUwwQ1EvDQpLalVyQzdNNlcrWmhpY2MwaWhid2IwM3BwTHY5L3ZiajA2TVk0K0hNaXZLaUsxb3hkK1E9DQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t

quota_min_vms=min-vms
quota_max_vms=max-vms

--===============7832870659841679070==
Content-Type: text/x-shellscript; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment; filename="test_script.sh"

#!/bin/bash
###############
# TEST SCRIPT #
###############
useradd cernvm
mkdir /home/cernvm/jobs/
mkdir /home/cernvm/jobs/log/
mkdir /home/cernvm/jobs/output/
mkdir /home/cernvm/jobs/error/
cat<< EOF > /home/cernvm/jobs/test.jdl
Universe = vanilla
Executable = /home/cernvm/jobs/test.sh
Log = /home/cernvm/jobs/log/test.log.\$(Cluster)\$(Process)
Output = /home/cernvm/jobs/output/test.out.\$(Cluster)\$(Process)
Error = /home/cernvm/jobs/error/test.err.\$(Cluster)\$(Process)
Queue 10
EOF
#
cat <<EOF> /home/cernvm/jobs/test.sh
#!/bin/bash
HOST=\$(hostname -I | awk '{print $1}')
DIR=\$(pwd)
sleep 5
echo "I'm sleeping in \$HOST"
echo ":-("
echo "More precisely in this directory \$DIR" 
echo ":-/"
sleep 20
echo "Now I'm running! So fun! :-)"
EOF
#
chown cernvm:root -R /home/cernvm/jobs/
chmod u+x -R /home/cernvm/jobs/
#
cat<<EOF>/root/README.txt
Root user can't submit condor jobs.
You can submit jobs using cernvm user and you can test condor using the test.jdl file [ condor_submit jobs/test.jdl ].
Good fun! :)
EOF

--===============7832870659841679070==--
